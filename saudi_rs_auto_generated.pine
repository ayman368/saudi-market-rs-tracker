//=============================================================================
// Saudi Market RS Rating - Auto-Generated
// Data Source: https://github.com/Youssef-Waheed1/lumivst_test
// Total Stocks: 284
// Last Update: 2025-12-09 17:15
// 
// This script is AUTO-GENERATED by GitHub Actions
// Do NOT edit manually - changes will be overwritten
//=============================================================================

//@version=5
indicator(title='Saudi RS (Auto-Updated)', shorttitle='Saudi RS Auto', overlay=true, max_bars_back = 253)

// ===== EMBEDDED DATA (Auto-Generated) =====
// This data is automatically updated daily from CSV

var string[] SYMBOLS = array.from("1010.0", "1020.0", "1030.0", "1040.0", "1050.0", "1060.0", "1080.0", "1090.0", "1111.0", "1120.0", "1140.0", "1150.0", "1180.0", "1182.0", "1183.0", "1201.0", "1202.0", "1210.0", "1211.0", "1212.0", "1213.0", "1214.0", "1301.0", "1302.0", "1303.0", "1304.0", "1310.0", "1320.0", "1321.0", "1322.0", "1323.0", "1330.0", "1810.0", "1820.0", "1830.0", "1831.0", "1832.0", "1833.0", "1834.0", "1835.0", "2001.0", "2002.0", "2010.0", "2020.0", "2030.0", "2040.0", "2050.0", "2060.0", "2070.0", "2080.0", "2081.0", "2082.0", "2083.0", "2084.0", "2090.0", "2100.0", "2110.0", "2120.0", "2130.0", "2140.0", "2150.0", "2160.0", "2170.0", "2180.0", "2190.0", "2200.0", "2210.0", "2220.0", "2222.0", "2223.0", "2230.0", "2240.0", "2250.0", "2260.0", "2270.0", "2280.0", "2281.0", "2282.0", "2283.0", "2284.0", "2285.0", "2286.0", "2287.0", "2290.0", "2300.0", "2310.0", "2320.0", "2330.0", "2340.0", "2350.0", "2360.0", "2370.0", "2380.0", "2381.0", "2382.0", "3001.0", "3002.0", "3003.0", "3004.0", "3005.0", "3007.0", "3008.0", "3010.0", "3020.0", "3030.0", "3040.0", "3050.0", "3060.0", "3080.0", "3090.0", "3091.0", "3092.0", "4001.0", "4002.0", "4003.0", "4004.0", "4005.0", "4006.0", "4007.0", "4008.0", "4009.0", "4010.0", "4011.0", "4012.0", "4013.0", "4014.0", "4015.0", "4016.0", "4017.0", "4018.0", "4019.0", "4020.0", "4021.0", "4030.0", "4031.0", "4040.0", "4050.0", "4051.0", "4061.0", "4070.0", "4071.0", "4072.0", "4080.0", "4081.0", "4082.0", "4083.0", "4084.0", "4090.0", "4100.0", "4110.0", "4130.0", "4140.0", "4141.0", "4142.0", "4143.0", "4144.0", "4145.0", "4146.0", "4150.0", "4160.0", "4161.0", "4162.0", "4163.0", "4164.0", "4165.0", "4170.0", "4180.0", "4190.0", "4191.0", "4192.0", "4193.0", "4194.0", "4200.0", "4210.0", "4220.0", "4230.0", "4240.0", "4250.0", "4260.0", "4261.0", "4262.0", "4263.0", "4264.0", "4265.0", "4270.0", "4280.0", "4290.0", "4291.0", "4292.0", "4300.0", "4310.0", "4320.0", "4321.0", "4322.0", "4323.0", "4324.0", "4325.0", "4326.0", "4330.0", "4331.0", "4332.0", "4333.0", "4334.0", "4335.0", "4336.0", "4337.0", "4338.0", "4339.0", "4340.0", "4342.0", "4344.0", "4345.0", "4346.0", "4347.0", "4348.0", "4349.0", "4350.0", "5110.0", "6001.0", "6002.0", "6004.0", "6010.0", "6012.0", "6013.0", "6014.0", "6015.0", "6016.0", "6017.0", "6018.0", "6019.0", "6020.0", "6040.0", "6050.0", "6060.0", "6070.0", "6080.0", "6090.0", "7010.0", "7020.0", "7030.0", "7040.0", "7200.0", "7201.0", "7202.0", "7203.0", "7204.0", "7211.0", "8010.0", "8011.0", "8012.0", "8020.0", "8030.0", "8040.0", "8050.0", "8060.0", "8070.0", "8080.0", "8090.0", "8100.0", "8110.0", "8120.0", "8130.0", "8140.0", "8150.0", "8160.0", "8170.0", "8180.0", "8190.0", "8200.0", "8210.0", "8220.0", "8230.0", "8240.0", "8250.0", "8260.0", "8270.0", "8280.0", "8290.0", "8300.0", "8310.0", "8311.0", "8312.0", "8313.0", "nan")
var string[] COMPANIES = array.from("RIBL", "BJAZ", "SAIB", "ALAWWAL", "BSF", "SAB", "ANB", "SAMBA", "TADAWUL GROUP", "ALRAJHI", "ALBILAD", "ALINMA", "SNB", "AMLAK", "SHL", "TAKWEEN", "MEPCO", "BCI", "MAADEN", "ASTRA INDUSTRIAL", "NASEEJ", "SHAKER", "ASLAK", "BAWAN", "EIC", "ALYAMAMAH STEEL", "MMG", "SSP", "EAST PIPES", "AMAK", "UCIC", "ALKHODARI", "SEERA", "BAAN", "LEEJAM SPORTS", "MAHARAH", "SADR", "ALMAWARID", "SMASCO", "TAMKEEN", "CHEMANOL", "PETROCHEM", "SABIC", "SABIC AGRI-NUTRIENTS", "SARCO", "SAUDI CERAMICS", "SAVOLA GROUP", "TASNEE", "SPIMACO", "GASCO", "AWPT", "ACWA POWER", "MARAFIQ", "MIAHONA", "NGC", "WAFRAH", "SAUDI CABLE", "SAIC", "SIDC", "AYYAN", "ZOUJAJ", "AMIANTIT", "ALUJAIN", "FIPCO", "SISCO HOLDING", "APC", "NAMA CHEMICALS", "MAADANIYAH", "SAUDI ARAMCO", "LUBEREF", "CHEMICAL", "SENAAT", "SIIG", "SAHARA", "SADAFCO", "ALMARAI", "TANMIAH", "NAQI", "FIRST MILLS", "MODERN MILLS", "ARABIAN MILLS", "FOURTH MILLING", "ENTAJ", "YANSAB", "SPM", "SIPCHEM", "ALBABTAIN", "ADVANCED", "ARTEX", "SAUDI KAYAN", "SVCP", "MESC", "PETRO RABIGH", "ARABIAN DRILLING", "ADES", "HCC", "NAJRAN CEMENT", "CITY CEMENT", "NORTHERN CEMENT", "UACC", "OASIS", "ALKATHIRI", "ACC", "YC", "SAUDI CEMENT", "QACCO", "SPCC", "YCC", "EPCCO", "TCC", "JOUF CEMENT", "RIYADH CEMENT", "A.OTHAIM MARKET", "MOUWASAT", "EXTRA", "DALLAH HEALTH", "CARE", "FARM SUPERSTORES", "ALHAMMADI", "SACO", "SAUDI GERMAN HEALTH", "DUR", "LAZURDE", "ALASEEL", "SULAIMAN ALHABIB", "EQUIPMENT HOUSE", "JAMJOOM PHARMA", "AVALON PHARMA", "FAKEEH CARE", "ALMOOSA", "SMC HEALTHCARE", "ALAKARIA", "CMCER", "BAHRI", "SGS", "SAPTCO", "SASCO", "BAAZEEM", "ANAAM HOLDING", "TAPRCO", "ALARABIA", "MBC GROUP", "SINAD HOLDING", "NAYIFAT", "MRNA", "TASHEEL", "DERAYAH", "TAIBA", "MCDC", "BATIC", "SAUDI DARB", "SIECO", "ALOMRAN", "RIYADH CABLES", "TALCO", "RAOOM", "OBEIKAN GLASS", "GAS", "ARDCO", "THIMAR", "BINDAWOOD", "ALMUNAJEM", "ALDAWAA", "NAHDI", "ALMAJED OUD", "TECO", "FITAIHI GROUP", "JARIR", "ABO MOATI", "ALSAIF GALLERY", "NICE ONE", "BUILD STATION", "ALDREES", "SRMG", "EMAAR EC", "RED SEA", "CENOMI RETAIL", "JABAL OMAR", "BUDGET SAUDI", "THEEB", "LUMI", "SAL", "FLYNAS", "CHERRY", "SPPC", "KINGDOM", "ALKHALEEJ TRNG", "NCLE", "ATAA", "DAR ALARKAN", "KEC", "ALANDALUS", "CENOMI CENTERS", "RETAL", "SUMOU", "BANAN", "MASAR", "ALMAJDIAH", "RIYAD REIT", "ALJAZIRA REIT", "JADWA REIT ALHARAMAIN", "TALEEM REIT", "AL MAATHER REIT", "MUSHARAKA REIT", "MULKIA REIT", "AL AZIZIAH REIT", "ALAHLI REIT 1", "DERAYAH REIT", "AL RAJHI REIT", "JADWA REIT SAUDI", "SEDCO CAPITAL REIT", "ALINMA RETAIL REIT", "MEFIC REIT", "BONYAN REIT", "ALKHABEER REIT", "ALINMA HOSPITALITY REIT", "ALISTITHMAR REIT", "SAUDI ELECTRICITY", "HB", "HERFY FOODS", "CATRION", "NADEC", "RAYDAN", "DWF", "ALAMAR", "AMERICANA", "BURGERIZZR", "JAHEZ", "SPORT CLUBS", "ALMASAR ALSHAMIL", "GACO", "TADCO", "SFICO", "SHARQIYAH DEV", "ALJOUF", "BISHAH AGRICULTURE", "JAZADCO", "STC", "ETIHAD ETISALAT", "ZAIN KSA", "GO TELECOM", "MIS", "ARAB SEA", "SOLUTIONS", "ELM", "2P", "AZM", "TAWUNIYA", "METLIFE AIG ANB", "JAZIRA TAKAFUL", "MALATH INSURANCE", "MEDGULF", "MUTAKAMELA", "SALAMA", "WALAA", "ARABIAN SHIELD", "SABB TAKAFUL", "SANAD", "SAICO", "WAFA INSURANCE", "GULF UNION ALAHLIA", "ATC", "ALAHLIA", "ACIG", "AICC", "ALETIHAD", "ALSAGR INSURANCE", "UCA", "SAUDI RE", "BUPA ARABIA", "WEQAYA TAKAFUL", "ALRAJHI TAKAFUL", "CHUBB", "GIG", "GULF GENERAL", "BURUJ", "LIVA", "SOLIDARITY", "WATANIYA", "AMANA INSURANCE", "ENAYA", "ALINMA TOKIO M", "RASAN", "CGS")
var int[] RS_VALUES = array.from(72, 54, 62, 78, 77, 77, 87, 85, 48, 85, 70, 60, 92, 60, 63, 23, 32, 71, 94, 48, 1, 41, 54, 65, 99, 84, 77, 17, 93, 99, 25, 77, 89, 37, 17, 88, 59, 89, 41, 51, 16, 74, 50, 89, 49, 75, 66, 67, 76, 76, 76, 22, 62, 31, 37, 19, 77, 6, 10, 70, 34, 25, 31, 29, 81, 30, 44, 53, 73, 79, 63, 87, 24, 84, 32, 40, 6, 87, 51, 56, 56, 68, 19, 54, 69, 28, 99, 61, 49, 72, 22, 8, 90, 86, 92, 78, 28, 15, 56, 21, 45, 52, 60, 14, 47, 53, 19, 39, 27, 38, 43, 25, 18, 54, 68, 69, 37, 29, 24, 69, 3, 80, 54, 45, 78, 36, 58, 67, 25, 91, 59, 6, 33, 99, 36, 7, 70, 90, 10, 9, 82, 46, 31, 69, 49, 83, 70, 44, 67, 38, 9, 52, 55, 78, 36, 50, 37, 38, 29, 55, 31, 30, 21, 34, 85, 14, 40, 74, 97, 44, 7, 19, 89, 29, 27, 26, 59, 18, 63, 57, 34, 60, 33, 88, 18, 74, 34, 64, 59, 37, 59, 28, 63, 59, 45, 22, 39, 20, 54, 42, 46, 82, 70, 65, 70, 78, 55, 62, 70, 89, 49, 71, 59, 77, 68, 76, 54, 60, 19, 16, 13, 33, 29, 62, 14, 41, 39, 4, 46, 71, 59, 20, 6, 33, 61, 50, 26, 81, 94, 81, 47, 93, 24, 44, 41, 42, 68, 63, 51, 41, 13, 9, 37, 14, 42, 24, 77, 77, 38, 77, 37, 77, 77, 17, 39, 7, 20, 1, 52, 57, 77, 5, 37, 47, 17, 65, 44, 77, 21, 13, 12, 77, 99, 77)

var int TOTAL_STOCKS = 284
var string LAST_UPDATE = "2025-12-09 17:15"

// ===== CONFIGURATION =====
comparativeTickerId = 'TADAWUL:TASI'

// ===== INPUTS =====
hideRSRat   = input(false, title='Hide Rating', group = 'RS Line')
colorRS     = input(color.rgb(0, 0, 255,0), title = 'Color', group = 'RS Line')
lineTicker  = input('TADAWUL:TASI', title='Comparative Symbol', group = 'Display')
IndexValue  = input(11500, title='Approximate TASI Value', group = 'Display')
offset      = input.int(80, minval = 0, maxval = 2000, title='Offset (%)', group = 'Display')
showTable   = input(true, title='Show RS Table', group = 'Display')

// ===== FIND CURRENT STOCK RS =====
var int currentRS = na
var string currentCompany = ""
var int stockIndex = -1

// Extract symbol from current ticker (e.g., "TADAWUL:1120" → "1120")
currentSymbol = str.tostring(syminfo.ticker)

// Search for current stock in our data
for i = 0 to array.size(SYMBOLS) - 1
    if str.tostring(array.get(SYMBOLS, i)) == currentSymbol
        stockIndex := i
        currentRS := array.get(RS_VALUES, i)
        currentCompany := array.get(COMPANIES, i)
        break

// ===== RS LINE CALCULATION =====
n63  = bar_index < 63  ? bar_index : 63 
n126 = bar_index < 126 ? bar_index : 126
n189 = bar_index < 189 ? bar_index : 189
n252 = bar_index < 252 ? bar_index : 252

comparativeSymbol = request.security(lineTicker, timeframe.period, close)
rsCurve = (close/comparativeSymbol)
rsRatio = timeframe.isweekly ? IndexValue*(offset-10)/100 : IndexValue*offset/100
rs = rsCurve*rsRatio

rsPlot = plot(rs, title='RS Line', style=plot.style_line, linewidth=1, color=colorRS)

// ===== RS TABLE =====
var table rsInfoTable = table.new(position.top_right, 2, 5, 
     bgcolor = color.new(color.rgb(30, 34, 45), 10), 
     border_width = 1, 
     border_color = color.new(color.rgb(42, 46, 57), 50))

if barstate.islast and showTable and timeframe.isdaily
    // Header
    table.cell(rsInfoTable, 0, 0, "Saudi RS", text_color = color.white, 
               bgcolor = color.rgb(42, 46, 57), text_size = size.normal)
    table.cell(rsInfoTable, 1, 0, "Data", text_color = color.white, 
               bgcolor = color.rgb(42, 46, 57), text_size = size.normal)
    
    // Company
    table.cell(rsInfoTable, 0, 1, "Company", text_color = color.rgb(120, 123, 134), text_size = size.small)
    companyText = stockIndex >= 0 ? currentCompany : "N/A"
    table.cell(rsInfoTable, 1, 1, companyText, text_color = color.white, text_size = size.small)
    
    // Symbol
    table.cell(rsInfoTable, 0, 2, "Symbol", text_color = color.rgb(120, 123, 134), text_size = size.small)
    table.cell(rsInfoTable, 1, 2, currentSymbol, text_color = color.white, text_size = size.small)
    
    // RS Rating
    table.cell(rsInfoTable, 0, 3, "RS Rating", text_color = color.rgb(120, 123, 134), text_size = size.small)
    rsText = stockIndex >= 0 ? str.tostring(currentRS) : "N/A"
    rsColor = currentRS >= 80 ? color.new(color.rgb(0, 230, 119), 20) : 
              currentRS >= 50 ? color.new(color.rgb(0, 150, 255), 20) : 
              color.new(color.rgb(255, 82, 82), 20)
    table.cell(rsInfoTable, 1, 3, rsText, text_color = color.white, 
               bgcolor = stockIndex >= 0 ? rsColor : na, text_size = size.large)
    
    // Rank
    table.cell(rsInfoTable, 0, 4, "Rank", text_color = color.rgb(120, 123, 134), text_size = size.small)
    rankText = stockIndex >= 0 ? "#" + str.tostring(TOTAL_STOCKS - stockIndex) + " / " + str.tostring(TOTAL_STOCKS) : "N/A"
    table.cell(rsInfoTable, 1, 4, rankText, text_color = color.rgb(209, 212, 220), text_size = size.tiny)

// ===== DISPLAY RS LABEL =====
isDaily = timeframe.isdaily
labelText = stockIndex >= 0 ? str.tostring(currentRS) : "N/A"
labelColor = currentRS >= 80 ? color.new(color.rgb(0, 230, 119), 20) : 
             currentRS >= 50 ? color.new(color.rgb(0, 150, 255), 20) : 
             color.new(color.rgb(255, 82, 82), 20)

label1 = (hideRSRat == false) and barstate.islast and isDaily and stockIndex >= 0 ? 
         label.new(bar_index, rs, text='     RS: ' + labelText, 
                   color = labelColor, size=size.normal, 
                   textcolor=color.white, 
                   style=label.style_label_left, 
                   yloc=yloc.price) : na

// Delete previous label
label.delete(label1[1])

// Warning for non-Saudi stocks
if barstate.islast and stockIndex < 0
    label.new(bar_index, high, text='⚠️ Not a Saudi stock\nor data not available', 
              color=color.red, style=label.style_label_down, 
              textcolor=color.white, size=size.small)

// Warning for non-daily timeframe
if (not isDaily and barstate.islast)
    label.new(bar_index + 10, high, text='⚠️ Use Daily (1D)', 
              color=color.orange, style=label.style_label_down, 
              textcolor=color.white, size=size.small)

// ===== INFO =====
// Data updated: 2025-12-09 17:15
// Total stocks: 284
// GitHub: https://github.com/Youssef-Waheed1/lumivst_test
